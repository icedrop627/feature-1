# Supabase ë°±ì—”ë“œ ì—°ë™ êµ¬í˜„ ì™„ë£Œ ìš”ì•½

## êµ¬í˜„ ì™„ë£Œëœ ë‚´ìš©

### âœ… 1. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì„¤ê³„ ë° ë§ˆì´ê·¸ë ˆì´ì…˜
- **ìœ„ì¹˜**: `supabase/migrations/`
- **íŒŒì¼**:
  - `20231201000001_create_cities_table.sql` - ë„ì‹œ í…Œì´ë¸”
  - `20231201000002_create_profiles_table.sql` - í”„ë¡œí•„ í…Œì´ë¸” ë° Storage ë²„í‚·
  - `20231201000003_create_reviews_table.sql` - ë¦¬ë·° í…Œì´ë¸”
  - `20231201000004_create_city_reactions_table.sql` - ì¢‹ì•„ìš”/ì‹«ì–´ìš” í…Œì´ë¸” ë° íŠ¸ë¦¬ê±°
  - `20231201000005_enable_rls_policies.sql` - RLS ì •ì±…
  - `20231201000006_create_profile_trigger.sql` - í”„ë¡œí•„ ìë™ ìƒì„± íŠ¸ë¦¬ê±°
  - `20231201000007_seed_cities_data.sql` - ì´ˆê¸° ë°ì´í„° ì‹œë”©

### âœ… 2. TypeScript íƒ€ì… ì‹œìŠ¤í…œ
- **ìœ„ì¹˜**: `lib/database.types.ts`, `lib/types.ts`
- **ë‚´ìš©**:
  - Supabase ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆì— ë§ëŠ” TypeScript íƒ€ì… ì •ì˜
  - Database íƒ€ì…ì„ í™œìš©í•œ íƒ€ì… ì•ˆì „ì„± í™•ë³´

### âœ… 3. API ë ˆì´ì–´ êµ¬í˜„
- **ìœ„ì¹˜**: `lib/api/`
- **íŒŒì¼**:
  - `cities.ts` - ë„ì‹œ ì¡°íšŒ, í•„í„°ë§, ì •ë ¬, ì¢‹ì•„ìš”/ì‹«ì–´ìš” API
  - `profiles.ts` - í”„ë¡œí•„ CRUD ë° ì´ë¯¸ì§€ ì—…ë¡œë“œ API

### âœ… 4. ì¸ì¦ ë¯¸ë“¤ì›¨ì–´
- **ìœ„ì¹˜**: `middleware.ts`
- **ê¸°ëŠ¥**:
  - Supabase ì„¸ì…˜ ìë™ ê°±ì‹ 
  - ë³´í˜¸ëœ ë¼ìš°íŠ¸ ì ‘ê·¼ ì œì–´ (`/profile`, `/settings`)
  - ì¸ì¦ëœ ì‚¬ìš©ìì˜ ë¡œê·¸ì¸/íšŒì›ê°€ì… í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸

### âœ… 5. UI ì»´í¬ë„ŒíŠ¸ ì—°ë™
- **ìˆ˜ì •ëœ íŒŒì¼**:
  - `app/page.tsx` - ì„œë²„ ì»´í¬ë„ŒíŠ¸ë¡œ ë³€ê²½, Supabase ë°ì´í„° ì¡°íšŒ
  - `components/home/city-grid-wrapper.tsx` - í´ë¼ì´ì–¸íŠ¸ í•„í„°ë§ ë˜í¼
  - `components/home/city-card.tsx` - DB í•„ë“œëª… ëŒ€ì‘
  - `components/home/city-grid.tsx` - DB í•„ë“œëª… ëŒ€ì‘ ë° null ì²˜ë¦¬

### âœ… 6. ë¡œë”© ë° ì—ëŸ¬ ìƒíƒœ
- **ìƒˆ íŒŒì¼**:
  - `app/loading.tsx` - í˜ì´ì§€ ë¡œë”© ìŠ¤ì¼ˆë ˆí†¤ UI
  - `app/error.tsx` - ì—ëŸ¬ í˜ì´ì§€
  - `components/ui/skeleton.tsx` - Skeleton ì»´í¬ë„ŒíŠ¸
  - `components/home/city-card-skeleton.tsx` - ë„ì‹œ ì¹´ë“œ ìŠ¤ì¼ˆë ˆí†¤

### âœ… 7. ë¬¸ì„œí™”
- `SUPABASE_SETUP.md` - Supabase ì„¤ì • ê°€ì´ë“œ

## ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰í•´ì•¼ í•  ì‘ì—…

### ğŸ”§ Supabase ì„¤ì • (í•„ìˆ˜)
1. Supabase í”„ë¡œì íŠ¸ ìƒì„±
2. SQL ì—ë””í„°ì—ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰
3. `.env.local` íŒŒì¼ì— í™˜ê²½ ë³€ìˆ˜ ì„¤ì • í™•ì¸

### ğŸ—‘ï¸ ì •ë¦¬ ì‘ì—… (ê¶Œì¥)
```bash
# k-nomad-issue-6 ì›Œí¬íŠ¸ë¦¬ ì œê±°
git worktree remove k-nomad-issue-6

# mock ë°ì´í„° íŒŒì¼ ì œê±° ë˜ëŠ” ë³´ê´€
# lib/mock-data/cities.tsëŠ” ì°¸ê³ ìš©ìœ¼ë¡œ ë³´ê´€ ê°€ëŠ¥
```

### ğŸ§ª í…ŒìŠ¤íŠ¸
```bash
# ê°œë°œ ì„œë²„ ì‹¤í–‰
npm run dev

# í…ŒìŠ¤íŠ¸ í•­ëª©:
# 1. íšŒì›ê°€ì…/ë¡œê·¸ì¸
# 2. ë„ì‹œ ëª©ë¡ ì¡°íšŒ
# 3. í•„í„°ë§ ê¸°ëŠ¥
# 4. ì •ë ¬ ê¸°ëŠ¥
```

### ğŸ“‹ ì´ìŠˆ ì‘ì—…
í˜„ì¬ ì—´ë ¤ìˆëŠ” GitHub ì´ìŠˆ:
- **ì´ìŠˆ #1**: í”„ë¡œí•„ í˜ì´ì§€ UI ê¸°ë³¸ êµ¬ì¡° ë° ë ˆì´ì•„ì›ƒ êµ¬í˜„
- **ì´ìŠˆ #2**: í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ ë° ë³€ê²½ êµ¬í˜„
- **ì´ìŠˆ #3**: ì‚¬ìš©ì ì†Œê°œ í¸ì§‘ ê¸°ëŠ¥ êµ¬í˜„
- **ì´ìŠˆ #4**: ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ê¸°ëŠ¥ êµ¬í˜„
- **ì´ìŠˆ #5**: ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥ êµ¬í˜„

## êµ¬í˜„ëœ ì•„í‚¤í…ì²˜

```
Frontend (Next.js 16)
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ page.tsx (ì„œë²„ ì»´í¬ë„ŒíŠ¸ - ë°ì´í„° ì¡°íšŒ)
â”‚   â”œâ”€â”€ login/page.tsx
â”‚   â”œâ”€â”€ register/page.tsx
â”‚   â”œâ”€â”€ loading.tsx
â”‚   â””â”€â”€ error.tsx
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ home/
â”‚   â”‚   â”œâ”€â”€ city-grid-wrapper.tsx (í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸)
â”‚   â”‚   â”œâ”€â”€ city-card.tsx
â”‚   â”‚   â””â”€â”€ filter-sidebar.tsx
â”‚   â””â”€â”€ layout/
â”‚       â””â”€â”€ navigation.tsx (ì¸ì¦ ìƒíƒœ í‘œì‹œ)
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ cities.ts (ë„ì‹œ API)
â”‚   â”‚   â””â”€â”€ profiles.ts (í”„ë¡œí•„ API)
â”‚   â”œâ”€â”€ supabase/
â”‚   â”‚   â”œâ”€â”€ client.ts (ë¸Œë¼ìš°ì € í´ë¼ì´ì–¸íŠ¸)
â”‚   â”‚   â””â”€â”€ server.ts (ì„œë²„ í´ë¼ì´ì–¸íŠ¸)
â”‚   â”œâ”€â”€ database.types.ts (DB íƒ€ì…)
â”‚   â””â”€â”€ types.ts (ì•± íƒ€ì…)
â””â”€â”€ middleware.ts (ì¸ì¦ ë¯¸ë“¤ì›¨ì–´)

Backend (Supabase)
â”œâ”€â”€ auth.users (ì¸ì¦ ì‚¬ìš©ì)
â”œâ”€â”€ public.profiles (ì‚¬ìš©ì í”„ë¡œí•„)
â”œâ”€â”€ public.cities (ë„ì‹œ ì •ë³´)
â”œâ”€â”€ public.reviews (ë¦¬ë·°)
â”œâ”€â”€ public.city_reactions (ì¢‹ì•„ìš”/ì‹«ì–´ìš”)
â””â”€â”€ storage.avatars (í”„ë¡œí•„ ì´ë¯¸ì§€)
```

## ì£¼ìš” ê¸°ëŠ¥

### 1. ì¸ì¦ ì‹œìŠ¤í…œ
- âœ… ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ íšŒì›ê°€ì…
- âœ… ë¡œê·¸ì¸
- âœ… ìë™ í”„ë¡œí•„ ìƒì„± (íŠ¸ë¦¬ê±°)
- âœ… ì„¸ì…˜ ê´€ë¦¬ (ë¯¸ë“¤ì›¨ì–´)
- â³ ë¡œê·¸ì•„ì›ƒ (Navigationì— êµ¬í˜„ë¨, ì´ìŠˆ #5ì—ì„œ í…ŒìŠ¤íŠ¸ í•„ìš”)

### 2. ë„ì‹œ ì •ë³´
- âœ… ë„ì‹œ ëª©ë¡ ì¡°íšŒ
- âœ… í•„í„°ë§ (ì˜ˆì‚°, ì§€ì—­, í™˜ê²½, ê³„ì ˆ)
- âœ… ì •ë ¬ (ì¢‹ì•„ìš”ìˆœ, ìƒí™œë¹„ìˆœ)
- âœ… ê²€ìƒ‰
- â³ ì¢‹ì•„ìš”/ì‹«ì–´ìš” (UIë§Œ êµ¬í˜„, DB ì—°ë™ í•„ìš”)

### 3. ë³´ì•ˆ
- âœ… Row Level Security (RLS) ì •ì±…
- âœ… ì‚¬ìš©ìë³„ ë°ì´í„° ì ‘ê·¼ ì œì–´
- âœ… Storage ë²„í‚· ê¶Œí•œ ì„¤ì •

### 4. ì‚¬ìš©ì ê²½í—˜
- âœ… ë¡œë”© ìŠ¤ì¼ˆë ˆí†¤
- âœ… ì—ëŸ¬ ì²˜ë¦¬
- âœ… ë°˜ì‘í˜• UI
- âœ… ë‹¤í¬ëª¨ë“œ ì§€ì›

## ê¸°ìˆ  ìŠ¤íƒ

- **Frontend**: Next.js 16 (App Router), React 19, TypeScript
- **Backend**: Supabase (PostgreSQL, Auth, Storage)
- **UI**: Tailwind CSS, shadcn/ui
- **State**: React Hooks, Server Components
- **Auth**: Supabase Auth with SSR

## ì°¸ê³  ì‚¬í•­

### Mock ë°ì´í„°ì™€ DB í•„ë“œëª… ì°¨ì´
- Mock: `coverImage`, `monthlyCost`, `bestSeason`
- DB: `cover_image`, `monthly_cost`, `best_season`
- ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ DB í•„ë“œëª…ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë¨

### ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ ìˆœì„œ
ë°˜ë“œì‹œ íŒŒì¼ëª… ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤ (ì˜ì¡´ì„± ìˆìŒ).

### TypeScript ì—ëŸ¬
- k-nomad-issue-6 í´ë”ì˜ ì˜¤ë˜ëœ íŒŒì¼ë“¤ì— íƒ€ì… ì—ëŸ¬ê°€ ìˆì„ ìˆ˜ ìˆìŒ
- ì´ í´ë”ëŠ” ì‚­ì œí•´ë„ ë¬´ë°©

## ì„±ê³¼

âœ… **9ê°œì˜ ì£¼ìš” ì‘ì—… ì™„ë£Œ**:
1. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì„¤ê³„ ë° SQL ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìƒì„±
2. Row Level Security (RLS) ì •ì±… SQL ì‘ì„±
3. ì¸ì¦ ë¯¸ë“¤ì›¨ì–´ êµ¬í˜„ (middleware.ts)
4. ì‚¬ìš©ì í”„ë¡œí•„ ìë™ ìƒì„± íŠ¸ë¦¬ê±° ì‘ì„±
5. TypeScript ë°ì´í„°ë² ì´ìŠ¤ íƒ€ì… ì •ì˜ ì—…ë°ì´íŠ¸
6. ë„ì‹œ ë°ì´í„° API í•¨ìˆ˜ êµ¬í˜„ (lib/api/cities.ts)
7. í™ˆí˜ì´ì§€ë¥¼ ì‹¤ì œ Supabase ë°ì´í„°ì™€ ì—°ë™
8. ì´ˆê¸° ë„ì‹œ ë°ì´í„° ì‹œë”© SQL ì‘ì„±
9. ì—ëŸ¬ í•¸ë“¤ë§ ë° ë¡œë”© ìƒíƒœ ê°œì„ 

ğŸ‰ **ì™„ì „í•œ í’€ìŠ¤íƒ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°±ì—”ë“œ êµ¬ì¶• ì™„ë£Œ!**
